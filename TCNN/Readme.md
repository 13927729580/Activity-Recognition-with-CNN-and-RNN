# Temporal Convolutional Neural Network (TCNN)
This folder contains codes to train TCNN using the beforehand generated feature vectors of UCF101 for video classification.

---
## Requirement
### Inputs
TCNN takes the **feature vectors** generated by the first stage spatial CNN as input for training. You can generate the features using our codes under "/CNN_Spatial/". You can also download the feature vectors generated by ourselves. (please refer to the Dropbox link below) We followed the first training/testing split from [UCF-101](http://crcv.ucf.edu/data/UCF101.php). If you would like to compare with our results, please use the same training and testing list, as it will affect your overall performance a lot.

* [Features for training](https://www.dropbox.com/s/ehla4szd8z8u8lw/data_UCF101_train_1.t7?dl=0)
* [Features for testing](https://www.dropbox.com/s/cma4swez0fabw47/data_UCF101_test_1.t7?dl=0)

You may also need to modify the code in *./data.lua* to the director where you put your feature vector files. (around line 21)
```bash
dirDatabase = '/home/cmhung/Desktop/Dataset/Features/'
dirFeature = dirDatabase..'Res/'
```

---
## Usage
### Training and Testing
```bash
$ qlua run.lua -r 15e-5
```
There are lots of tunable parameters for training. Please check *run.lua*.

#### Outputs
1. In the folder *./results/*, there are training and testing results.
2. *labels.txt*, *prob.txt*: inputs for *namelist.lua* to generate the text file for demo.

### Generate the outputs for demo
```bash
$ th namelist.lua > labels_tcnn.txt
```
The output text file has contains the Top N prediction labels and probabilities.

#### Outputs
*labels_tcnn.txt*: labels and probabilities for demo. (You can change the file name)

---
## Current Performance
We use a 2-layer architecture. Each layer includes one convolution layer and one max-pooling layer. Before the final softmax layer, there are two full-connected linear layers.

### model
hidden state #: 16 --> 32 --> 256
convolution kernel size: 3 --> 11
pooling size: 2 --> 2

### results
* training time: 53 epochs
* training accuracy: 100%
* testing accuracy: **77.47%**

---
#### Contact
[Min-Hung Chen](https://www.linkedin.com/in/chensteven) at <cmhungsteve@gatech.edu>

Last updated: 05/05/2016
